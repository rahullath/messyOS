---
import DashboardLayout from '../layouts/DashboardLayout.astro';
// Don't import React components in the frontmatter - they need client:load
---

<DashboardLayout title="Content - MeshOS">
  <div class="space-y-8">
    <!-- Header -->
    <div class="flex items-center justify-between">
      <div>
        <h1 class="text-3xl font-semibold text-text-primary mb-2">Content Tracking</h1>
        <p class="text-text-secondary">
          Track movies, shows, books, and get personalized recommendations
        </p>
      </div>
      <button 
        id="import-serializd-btn"
        class="flex items-center px-4 py-2 bg-accent-purple text-white rounded-lg hover:bg-accent-purple/90 transition-colors"
      >
        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
        </svg>
        Import Serializd
      </button>
    </div>

    <!-- Import Section - This will load the React component -->
    <div id="content-import-container"></div>

    <!-- Content Dashboard - This will load the React component -->
    <div id="content-dashboard-container"></div>
  </div>
</DashboardLayout>

<script>
  // Handle Serializd import button
  document.getElementById('import-serializd-btn')?.addEventListener('click', () => {
    // For now, just redirect to the import page
    window.location.href = '/import';
  });

  // We'll add the React components here using dynamic imports
  import('../components/import/ContentDataImport').then(({ default: ContentDataImport }) => {
    import('react').then(React => {
      import('react-dom/client').then(({ createRoot }) => {
        const container = document.getElementById('content-import-container');
        if (container) {
          const root = createRoot(container);
          root.render(React.createElement(ContentDataImport));
        }
      });
    });
  });

  import('../components/dashboard/ContentDashboardComponent').then(({ default: ContentDashboardComponent }) => {
    import('react').then(React => {
      import('react-dom/client').then(({ createRoot }) => {
        const container = document.getElementById('content-dashboard-container');
        if (container) {
          const root = createRoot(container);
          root.render(React.createElement(ContentDashboardComponent));
        }
      });
    });
  });
</script>